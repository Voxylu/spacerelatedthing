This code is ugly
**DON'T LOOK AT IT**
JUST IGNORE
